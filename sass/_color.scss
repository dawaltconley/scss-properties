@use '../node_modules/sass-true/sass/throw';
@use 'sass:list';
@use 'sass:map';
@use 'sass:math';
@use 'sass:meta';
@use 'var';

@function guessColor($args...) {
  $kwargs: meta.keywords($args);
  $rgb: false; $hsl: false;
  $hasAlpha: map.has-key($kwargs, 'alpha') or list.length($args) == 4;
  @if not $rgb and not $hsl {
    @each $property in map.keys($kwargs) {
      @if list.index(var.$RGB, $property) {
        $rgb: true;
      } @else if list.index(var.$HSL, $property) {
        $hsl: true;
      }
    }
  }

  @if $rgb and $hsl {
    $kwarglist: list.zip(map.keys($kwargs), map.values($kwargs));
    @return throw.error('Both RGB and HSL arguments supplied: #{$kwarglist}', 'guessColor()');
  }

  @if not $rgb and not $hsl {
    @if list.length($args) > 0 {
      $rgb: true; $i: 1;
      @while $rgb and $i <= list.length($args) {
        $a: list.nth($args, $i);
        @if meta.type-of($a) == 'number' and not math.is-unitless($a) {
          $rgb: false; $hsl: true;
        }
        $i: $i + 1;
      }
    } @else {
      $hsl: true;
    }
  }

  @if $hasAlpha and $rgb {
    @return var.$RGBA;
  } @else if $hasAlpha and $hsl {
    @return var.$HSLA;
  } @else if $rgb {
    @return var.$RGB;
  } @else if $hsl {
    @return var.$HSL;
  }

  @return null;
}

@function makeColor($args...) {
  $type: guessColor($args...);
  @if $type == var.$RGBA {
    @return rgba($args...);
  } @else if $type == var.$RGB {
    @return rgb($args...);
  } @else if $type == var.$HSLA {
    @return hsla($args...);
  } @else if $type == var.$HSL {
    @return hsl($args...);
  }

  @return $type;
}
